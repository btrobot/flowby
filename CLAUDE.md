# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

---

## é¡¹ç›®æ¦‚è¿°

**Flowby** æ˜¯ä¸€ä¸ª Python é£æ ¼çš„ Web è‡ªåŠ¨åŒ– DSLï¼ˆé¢†åŸŸç‰¹å®šè¯­è¨€ï¼‰ï¼ŒåŸºäº Playwright å®ç°æµè§ˆå™¨æ§åˆ¶ã€‚

- **å½“å‰ç‰ˆæœ¬**: v0.1.0 (è¯­æ³•ç‰ˆæœ¬ v5.1)
- **Python**: 3.8 - 3.12
- **æ ¸å¿ƒç‰¹æ€§**: å£°æ˜å¼è¯­æ³•ã€OpenAPI é›†æˆã€æ¨¡å—ç³»ç»Ÿã€äº¤äº’å¼è¾“å…¥

---

## å¼€å‘å‘½ä»¤

### ç¯å¢ƒè®¾ç½®

```bash
# å®‰è£…å¼€å‘ä¾èµ–
pip install -e ".[dev]"

# å®‰è£… Playwright æµè§ˆå™¨
playwright install chromium
```

### æµ‹è¯•

```bash
# è¿è¡Œå…¨éƒ¨æµ‹è¯•ï¼ˆæ¨èï¼‰
pytest

# è¿è¡Œç‰¹å®šæµ‹è¯•æ–‡ä»¶
pytest tests/grammar_alignment/test_v3_01_variables.py

# è¿è¡Œå•ä¸ªæµ‹è¯•
pytest tests/grammar_alignment/test_v3_01_variables.py::test_let_declaration_basic -v

# å¸¦è¦†ç›–ç‡
pytest --cov=flowby --cov-report=html

# æŸ¥çœ‹è¦†ç›–ç‡æŠ¥å‘Š
# htmlcov/index.html
```

### ä»£ç æ£€æŸ¥

```bash
# æ ¼å¼åŒ–ä»£ç 
black src/

# ä»£ç æ£€æŸ¥
flake8 src/

# ç±»å‹æ£€æŸ¥
mypy src/
```

### è¿è¡Œè„šæœ¬

```bash
# æ–¹å¼ä¸€ï¼šä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·
flowby examples/hello.flow

# æ–¹å¼äºŒï¼šä½¿ç”¨ Python æ¨¡å—
python -m flowby examples/hello.flow

# æ–¹å¼ä¸‰ï¼šç¼–ç¨‹æ–¹å¼
python
>>> from flowby import Lexer, Parser, Interpreter, ExecutionContext
>>> # ... æ‰§è¡Œä»£ç 
```

---

## æ ¸å¿ƒæ¶æ„

### ä¸‰é˜¶æ®µè§£é‡Šå™¨æ¨¡å‹

```
.flow æºæ–‡ä»¶
    â†“
[Lexer] è¯æ³•åˆ†æ (lexer.py)
    â†“ Token æµ
[Parser] è¯­æ³•åˆ†æ + è¯­ä¹‰æ£€æŸ¥ (parser.py)
    â†“ AST + ç¬¦å·è¡¨
[Interpreter] è§£é‡Šæ‰§è¡Œ (interpreter.py)
    â†“
    â”œâ”€ ExpressionEvaluator (è¡¨è¾¾å¼æ±‚å€¼)
    â”œâ”€ ExecutionContext (æ‰§è¡ŒçŠ¶æ€)
    â”œâ”€ Actions (æµè§ˆå™¨æ“ä½œ)
    â””â”€ PlaywrightWrapper (æµè§ˆå™¨æ§åˆ¶)
```

### å…³é”®è®¾è®¡æ¨¡å¼

- **Lexer**: ç¼©è¿›æ ˆç®—æ³•ï¼ˆPython é£æ ¼ç¼©è¿› â†’ INDENT/DEDENT tokensï¼‰
- **Parser**: é€’å½’ä¸‹é™è§£æï¼ˆæ¯ç§è¯­æ³•å¯¹åº”ä¸€ä¸ª `_parse_*()` æ–¹æ³•ï¼‰
- **Interpreter**: è®¿é—®è€…æ¨¡å¼ï¼ˆæ¯ç§èŠ‚ç‚¹å¯¹åº”ä¸€ä¸ª `visit_*()` æ–¹æ³•ï¼‰
- **SymbolTable**: ä½œç”¨åŸŸæ ˆï¼ˆæ”¯æŒåµŒå¥—ä½œç”¨åŸŸï¼‰
- **ExpressionEvaluator**: çŸ­è·¯æ±‚å€¼ï¼ˆä¼˜åŒ– and/or é€»è¾‘è¿ç®—ï¼‰

### å…³é”®æ¨¡å—é€ŸæŸ¥

| æ¨¡å— | èŒè´£ | è¡Œæ•° | å…³é”®å‡½æ•°/ç±» |
|------|------|------|-------------|
| `lexer.py` | è¯æ³•åˆ†æ | 1200 | `Lexer.tokenize()`, `TokenType` |
| `parser.py` | è¯­æ³•åˆ†æ | 3000 | `Parser.parse()`, `_parse_*()` æ–¹æ³• |
| `interpreter.py` | è§£é‡Šæ‰§è¡Œ | 1500 | `Interpreter.run()`, `visit_*()` æ–¹æ³• |
| `ast_nodes.py` | AST èŠ‚ç‚¹å®šä¹‰ | 800 | 40+ `*Node` ç±» |
| `expression_evaluator.py` | è¡¨è¾¾å¼æ±‚å€¼ | 800 | `ExpressionEvaluator.evaluate()` |
| `context.py` | æ‰§è¡Œä¸Šä¸‹æ–‡ | 600 | `ExecutionContext` |
| `symbol_table.py` | ç¬¦å·è¡¨ | 400 | `SymbolTableStack` |
| `actions/` | æµè§ˆå™¨åŠ¨ä½œ | 500 | `execute_*()` å‡½æ•° |

---

## v3.0 è¯­æ³•é©å‘½æ€§å˜æ›´

**v3.0 æ˜¯æœ€é‡å¤§çš„è¯­æ³•å˜é©**ï¼Œé‡‡ç”¨ Python é£æ ¼ç¼©è¿›ï¼š

### æ ¸å¿ƒå˜åŒ–

```python
# âœ… v3.0+ æ­£ç¡®è¯­æ³•ï¼ˆPython é£æ ¼ï¼‰
if user == "admin":
    log "Admin user"
else:
    log "Regular user"

# âŒ v2.0 æ—§è¯­æ³•ï¼ˆå·²åºŸå¼ƒï¼‰
if user == "admin":
    log "Admin user"
end if
```

### å…³é”®è¯­æ³•è§„åˆ™

1. **ç§»é™¤æ‰€æœ‰ `end` å…³é”®å­—**: `end if`, `end step`, `end for`, `end while` ç­‰å…¨éƒ¨ç§»é™¤
2. **é‡‡ç”¨ 4 ç©ºæ ¼ç¼©è¿›**: æ¯çº§ç¼©è¿›å¿…é¡»æ˜¯ 4 ç©ºæ ¼ï¼ˆæˆ– 1 Tab = 4 ç©ºæ ¼ï¼‰
3. **å¸ƒå°”å€¼**: `True` / `False` (é¦–å­—æ¯å¤§å†™)
4. **ç©ºå€¼**: `None` (è€Œé `null`)
5. **å­—ç¬¦ä¸²æ’å€¼**: `f"Hello, {name}!"` (Python f-string è¯­æ³•)

### ä¿®æ”¹ç°æœ‰ä»£ç æ—¶æ³¨æ„

- **æ‰€æœ‰æ§åˆ¶æµå—**: `if`, `else`, `for`, `while`, `step`, `when`, `otherwise`, `function`
- **å¿…é¡»ä½¿ç”¨å†’å· + æ¢è¡Œ + ç¼©è¿›å—**
- **ä¸è¦æ·»åŠ  `end` å…³é”®å­—**

---

## å®ä¾‹éš”ç¦»åŸåˆ™

**CRITICAL**: é¡¹ç›®é‡‡ç”¨ä¸¥æ ¼çš„å®ä¾‹éš”ç¦»æ¶æ„ï¼Œç¡®ä¿å¤šä»»åŠ¡å¹¶å‘å®‰å…¨ã€‚

### è®¾è®¡åŸåˆ™

1. **æ— å…¨å±€çŠ¶æ€**: ç¦æ­¢ä½¿ç”¨å…¨å±€å˜é‡å­˜å‚¨æ‰§è¡ŒçŠ¶æ€
2. **æ¯ä»»åŠ¡ç‹¬ç«‹ä¸Šä¸‹æ–‡**: æ¯ä¸ªè„šæœ¬æ‰§è¡Œåˆ›å»ºç‹¬ç«‹çš„ `ExecutionContext` å®ä¾‹
3. **ç»„ä»¶ç‹¬ç«‹**: æ¯ä¸ªä¸Šä¸‹æ–‡æœ‰ç‹¬ç«‹çš„ `ScreenshotManager`, `DiagnosisManager` ç­‰

### ä»£ç ç¤ºä¾‹

```python
# âœ… æ­£ç¡®ï¼šå®ä¾‹éš”ç¦»
def run_script(script_path: str):
    context = ExecutionContext(
        task_id=generate_uuid(),
        script_name=script_path.stem
    )
    interpreter = Interpreter()
    interpreter.run(ast, context)

# âŒ é”™è¯¯ï¼šå…¨å±€çŠ¶æ€
GLOBAL_VARIABLES = {}  # ä¸è¦è¿™æ ·åš
GLOBAL_PAGE = None     # ä¼šå¯¼è‡´å¹¶å‘é—®é¢˜
```

---

## æµ‹è¯•ç­–ç•¥

### æµ‹è¯•åˆ†ç±»

1. **è¯­æ³•å¯¹é½æµ‹è¯•** (`tests/grammar_alignment/`)
   - éªŒè¯æ‰€æœ‰ MASTER.md ä¸­å®šä¹‰çš„è¯­æ³•ç‰¹æ€§
   - 1082 ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œå…¨éƒ¨é€šè¿‡
   - æŒ‰è¯­æ³•ç‰ˆæœ¬ç»„ç»‡: `test_v3_*.py`, `test_v4_*.py`, `test_v5_*.py`

2. **å•å…ƒæµ‹è¯•** (`tests/unit/dsl/`)
   - æµ‹è¯•å•ä¸ªç»„ä»¶åŠŸèƒ½
   - è¦†ç›– Lexer, Parser, ExpressionEvaluator, Actions ç­‰

3. **é›†æˆæµ‹è¯•** (`examples/`)
   - ç«¯åˆ°ç«¯æµ‹è¯•çœŸå®åœºæ™¯
   - Web è‡ªåŠ¨åŒ–ç¤ºä¾‹ã€API é›†æˆç¤ºä¾‹

### pytest Markers

é¡¹ç›®æ³¨å†Œäº†ä»¥ä¸‹æµ‹è¯•æ ‡è®°ï¼ˆè§ `pyproject.toml`ï¼‰:

- `@pytest.mark.builtin`: å†…ç½®å‡½æ•°/å‘½åç©ºé—´æµ‹è¯•
- `@pytest.mark.error`: é”™è¯¯å¤„ç†æµ‹è¯•
- `@pytest.mark.execution`: æ‰§è¡Œæµç¨‹æµ‹è¯•
- `@pytest.mark.expressions`: è¡¨è¾¾å¼æ±‚å€¼æµ‹è¯•
- `@pytest.mark.feature`: ç‰¹å®š DSL åŠŸèƒ½æµ‹è¯•
- `@pytest.mark.integration`: é›†æˆæµ‹è¯•
- `@pytest.mark.v3_specific`: v3.0 è¯­æ³•ä¸“ç”¨æµ‹è¯•
- `@pytest.mark.v31`: v3.1 åŠŸèƒ½æµ‹è¯•
- `@pytest.mark.v40`: v4.0 åŠŸèƒ½æµ‹è¯•

**ä½¿ç”¨æ ‡è®°æ—¶è¯·ä½¿ç”¨å·²æ³¨å†Œçš„æ ‡è®°**ï¼Œé¿å… pytest è­¦å‘Šã€‚

---

## æ·»åŠ æ–°ç‰¹æ€§çš„æ ‡å‡†æµç¨‹

### 1. å®šä¹‰è¯­æ³•ï¼ˆå¦‚æœæ˜¯æ–°è¯­æ³•ï¼‰

æ›´æ–° `grammar/MASTER.md`ï¼Œéµå¾ªç°æœ‰æ ¼å¼ã€‚

### 2. è¯æ³•åˆ†æ

```python
# lexer.py

# æ·»åŠ  Token ç±»å‹
class TokenType(Enum):
    # ... ç°æœ‰ tokens
    NEW_KEYWORD = auto()

# æ·»åŠ å…³é”®å­—æ˜ å°„
KEYWORDS = {
    # ... ç°æœ‰å…³é”®å­—
    "newkeyword": TokenType.NEW_KEYWORD,
}
```

### 3. å®šä¹‰ AST èŠ‚ç‚¹

```python
# ast_nodes.py

@dataclass
class NewFeatureNode(ASTNode):
    """æ–°ç‰¹æ€§çš„ AST èŠ‚ç‚¹"""
    param1: Expression
    param2: List[ASTNode]
    line: int
```

### 4. è¯­æ³•è§£æ

```python
# parser.py

def _parse_new_feature(self) -> NewFeatureNode:
    """è§£ææ–°ç‰¹æ€§è¯­æ³•"""
    self.expect(TokenType.NEW_KEYWORD)
    param1 = self._parse_expression()
    self.expect(TokenType.COLON)
    self.expect(TokenType.NEWLINE)
    self.expect(TokenType.INDENT)
    param2 = self._parse_block()
    self.expect(TokenType.DEDENT)

    return NewFeatureNode(param1, param2, line)

# åœ¨ _parse_statement() ä¸­æ·»åŠ åˆ†æ”¯
def _parse_statement(self) -> ASTNode:
    if self.match(TokenType.NEW_KEYWORD):
        return self._parse_new_feature()
    # ... ç°æœ‰åˆ†æ”¯
```

### 5. è§£é‡Šæ‰§è¡Œ

```python
# interpreter.py

def visit_NewFeatureNode(self, node: NewFeatureNode):
    """æ‰§è¡Œæ–°ç‰¹æ€§èŠ‚ç‚¹"""
    value = self.evaluator.evaluate(node.param1)

    # æ‰§è¡Œé€»è¾‘
    for stmt in node.param2:
        self.visit(stmt)
```

### 6. æ·»åŠ æµ‹è¯•

```python
# tests/grammar_alignment/test_v5_new_feature.py

import pytest
from flowby.lexer import Lexer
from flowby.parser import Parser
from flowby.interpreter import Interpreter
from flowby.context import ExecutionContext

@pytest.mark.v5_specific
@pytest.mark.feature
def test_new_feature_basic():
    """æµ‹è¯•æ–°ç‰¹æ€§çš„åŸºæœ¬åŠŸèƒ½"""
    source = """
newkeyword condition:
    log "Hello"
    """

    tokens = Lexer().tokenize(source)
    ast = Parser().parse(tokens)
    context = ExecutionContext()
    interpreter = Interpreter()
    interpreter.run(ast, context)

    # æ–­è¨€é¢„æœŸè¡Œä¸º
    assert ...
```

### 7. æ›´æ–°æ–‡æ¡£

- `CHANGELOG.md`: æ·»åŠ å˜æ›´è®°å½•
- `grammar/MASTER.md`: æ›´æ–°è¯­æ³•è§„èŒƒ
- `README.md`: æ›´æ–°ç‰¹æ€§åˆ—è¡¨ï¼ˆå¦‚æœéœ€è¦ï¼‰

---

## ç¬¦å·è¡¨ä¸ä½œç”¨åŸŸ

### ä½œç”¨åŸŸè§„åˆ™

- **å…¨å±€ä½œç”¨åŸŸ**: é¡¶å±‚å®šä¹‰çš„å˜é‡
- **å‡½æ•°ä½œç”¨åŸŸ**: å‡½æ•°å†…éƒ¨å®šä¹‰çš„å˜é‡
- **å¾ªç¯ä½œç”¨åŸŸ**: for/while å¾ªç¯å˜é‡ï¼ˆå¾ªç¯å†…å¯è§ï¼‰
- **é—­åŒ…**: å‡½æ•°æ•è·å¤–å±‚ä½œç”¨åŸŸå˜é‡

### ç¬¦å·è¡¨æ“ä½œ

```python
# è¿›å…¥æ–°ä½œç”¨åŸŸï¼ˆå‡½æ•°ã€å¾ªç¯ï¼‰
context.symbol_table.push_scope()

# å®šä¹‰å˜é‡
context.symbol_table.define(name, symbol)

# æŸ¥æ‰¾å˜é‡ï¼ˆå‘ä¸ŠæŸ¥æ‰¾ï¼‰
symbol = context.symbol_table.lookup(name)

# é€€å‡ºä½œç”¨åŸŸ
context.symbol_table.pop_scope()
```

### è¯­ä¹‰æ£€æŸ¥è§„åˆ™

Parser åœ¨è§£ææ—¶è¿›è¡Œä»¥ä¸‹æ£€æŸ¥ï¼ˆé€šè¿‡ SymbolTableï¼‰ï¼š

- **VR-001**: å˜é‡ä½¿ç”¨å‰å¿…é¡»å£°æ˜
- **VR-002**: å¸¸é‡ä¸èƒ½é‡æ–°èµ‹å€¼
- **VR-003**: åŒä¸€ä½œç”¨åŸŸä¸èƒ½é‡å¤å£°æ˜
- **VR-004**: ç³»ç»Ÿå˜é‡ï¼ˆpage, envï¼‰åªè¯»

---

## æ¨¡å—ç³»ç»Ÿï¼ˆv5.0ï¼‰

### ä¸¤é˜¶æ®µæ‰§è¡Œ

1. **Library Definition Phase**: è§£æ library æ–‡ä»¶ï¼Œæ”¶é›† export ç¬¦å·
2. **Main Execution Phase**: å¤„ç† import è¯­å¥ï¼Œæ‰§è¡Œä¸»ç¨‹åº

### åº“æ–‡ä»¶ç¤ºä¾‹

```python
# lib/utils.flow
library utils

function greet(name):
    return f"Hello, {name}!"

export greet
```

### ä¸»æ–‡ä»¶ç¤ºä¾‹

```python
# main.flow
import {greet} from "utils"

let message = greet("Alice")
log message
```

### åº“æŸ¥æ‰¾è·¯å¾„ï¼ˆä¼˜å…ˆçº§ï¼‰

1. å½“å‰è„šæœ¬ç›®å½•
2. å½“å‰è„šæœ¬ç›®å½•/lib/
3. é¡¹ç›®æ ¹ç›®å½•/lib/
4. ç”¨æˆ·ä¸»ç›®å½•/.flowby/lib/
5. ç³»ç»Ÿåº“ç›®å½•

---

## è¡¨è¾¾å¼æ±‚å€¼

### è¿ç®—ç¬¦ä¼˜å…ˆçº§ï¼ˆä»é«˜åˆ°ä½ï¼‰

1. `()`, `[]`, `.` - æ‹¬å·ã€æ•°ç»„è®¿é—®ã€æˆå‘˜è®¿é—®
2. `not`, `-` (ä¸€å…ƒ) - é€»è¾‘éã€è´Ÿå·
3. `*`, `/`, `%` - ä¹˜é™¤æ¨¡
4. `+`, `-` - åŠ å‡
5. `<`, `<=`, `>`, `>=` - æ¯”è¾ƒ
6. `==`, `!=` - ç›¸ç­‰æ€§
7. `and` - é€»è¾‘ä¸ï¼ˆçŸ­è·¯ï¼‰
8. `or` - é€»è¾‘æˆ–ï¼ˆçŸ­è·¯ï¼‰

### çŸ­è·¯æ±‚å€¼

- `and`: å·¦ä¾§ä¸º False æ—¶ä¸æ±‚å€¼å³ä¾§
- `or`: å·¦ä¾§ä¸º True æ—¶ä¸æ±‚å€¼å³ä¾§

### ç±»å‹è½¬æ¢ï¼ˆTruthy/Falsyï¼‰

**Falsy å€¼**: `None`, `False`, `0`, `""`, `[]`, `{}`
**Truthy å€¼**: å…¶ä»–æ‰€æœ‰å€¼

---

## OpenAPI èµ„æºç³»ç»Ÿ

### å£°æ˜å¼èµ„æºå®šä¹‰

```python
# DSL è¯­æ³•
resource petstore:
    spec: "https://petstore3.swagger.io/api/v3/openapi.json"
    auth: {type: "bearer", token: env.API_TOKEN}
    resilience:
        retry: {max_retries: 3, strategy: "exponential"}

# ä½¿ç”¨
let pet = petstore.getPetById(petId=123)
log pet.name
```

### å®ç°æµç¨‹

1. Parser è§£æ `resource` å£°æ˜ä¸º `ResourceStatement` èŠ‚ç‚¹
2. Interpreter æ‰§è¡Œæ—¶åŠ è½½ OpenAPI spec
3. è‡ªåŠ¨ç”Ÿæˆ API å®¢æˆ·ç«¯ï¼ˆåŸºäº specï¼‰
4. æ³¨å†Œåˆ° `context.resources`
5. æ–¹æ³•è°ƒç”¨é€šè¿‡ `ExpressionEvaluator._eval_method_call()` æ‰§è¡Œ

---

## è¯Šæ–­ç³»ç»Ÿ

### åˆ†çº§è¯Šæ–­

- **minimal**: ä»…é”™è¯¯ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
- **basic**: é”™è¯¯ + å…³é”®æ“ä½œï¼ˆé»˜è®¤ï¼Œæ—¥å¸¸å¼€å‘ï¼‰
- **detailed**: å…¨é‡æ—¥å¿— + æ€§èƒ½æŒ‡æ ‡ï¼ˆè°ƒè¯•å¤æ‚é—®é¢˜ï¼‰

### å¯ç”¨è¯¦ç»†è¯Šæ–­

```python
step "å…³é”®æ­¥éª¤" with diagnosis detailed:
    # ä¼šè®°å½•è¯¦ç»†çš„æ‰§è¡Œæ—¥å¿—ã€æ€§èƒ½æŒ‡æ ‡ã€DOM å¿«ç…§
    navigate to "https://example.com"
    click "#submit"
```

### è¯Šæ–­è¾“å‡ºä½ç½®

```
flowby-output/
â”œâ”€â”€ diagnosis/
â”‚   â””â”€â”€ task-{uuid}.json
â””â”€â”€ screenshots/
    â””â”€â”€ task-{uuid}/
```

---

## å¸¸è§é—®é¢˜æ’æŸ¥

### ç¼©è¿›é”™è¯¯

```
é”™è¯¯: LexerError: ç¼©è¿›é‡ä¸æ˜¯ 4 çš„å€æ•°
åŸå› : ä½¿ç”¨äº† 2 ç©ºæ ¼æˆ– Tab æ··ç”¨
è§£å†³: ç»Ÿä¸€ä½¿ç”¨ 4 ç©ºæ ¼ç¼©è¿›
```

### å˜é‡æœªå®šä¹‰

```
é”™è¯¯: ParserError: æœªå®šä¹‰å˜é‡ 'x'
åŸå› : å˜é‡ä½¿ç”¨å‰æœªå£°æ˜
è§£å†³: å…ˆ let x = ... å†ä½¿ç”¨
å®šä½: symbol_table.py (VR-001 è§„åˆ™)
```

### å¸¸é‡é‡èµ‹å€¼

```
é”™è¯¯: ExecutionError: ä¸èƒ½ä¿®æ”¹å¸¸é‡ 'MAX'
åŸå› : å°è¯•ä¿®æ”¹ const å£°æ˜çš„å˜é‡
è§£å†³: ä½¿ç”¨ let å£°æ˜å¯å˜å˜é‡
å®šä½: symbol_table.py (VR-002 è§„åˆ™)
```

### é¡µé¢æœªåˆå§‹åŒ–

```
é”™è¯¯: ExecutionError: é¡µé¢æœªåˆå§‹åŒ–
åŸå› : ç›´æ¥æ‰§è¡Œæµè§ˆå™¨æ“ä½œï¼Œä½†æœªå…ˆ navigate
è§£å†³: å…ˆ navigate to URLï¼Œå†æ‰§è¡Œæ“ä½œ
å®šä½: actions/*.py
```

---

## å…³é”®å‚è€ƒæ–‡æ¡£

### å•ä¸€äº‹å®æ¥æº

- **`grammar/MASTER.md`**: å®Œæ•´è¯­æ³•è§„èŒƒï¼ˆ54 ä¸ªç‰¹æ€§ï¼‰
- **`ARCHITECTURE.md`**: å®Œæ•´æ¶æ„æ–‡æ¡£ï¼ˆ2155 è¡Œï¼‰
- **`QUICK_REFERENCE.md`**: å¿«é€Ÿå‚è€ƒæ‰‹å†Œ

### å˜æ›´å†å²

- **`CHANGELOG.md`**: æ‰€æœ‰ç‰ˆæœ¬å˜æ›´è®°å½•
- **`grammar/CHANGELOG.md`**: è¯­æ³•å˜æ›´å†å²

### å¼€å‘æŒ‡å—

- **`CONTRIBUTING.md`**: è´¡çŒ®æŒ‡å—
- **`pyproject.toml`**: é¡¹ç›®é…ç½®ï¼ˆä¾èµ–ã€å·¥å…·é…ç½®ï¼‰

---

## ä»£ç é£æ ¼

### Python è§„èŒƒ

- éµå¾ª PEP 8
- ä½¿ç”¨ black æ ¼å¼åŒ– (line-length=100)
- ä½¿ç”¨ flake8 æ£€æŸ¥
- ä½¿ç”¨ type hintsï¼ˆPython 3.8 å…¼å®¹ï¼‰

### å‘½åçº¦å®š

- **ç±»**: `PascalCase` (ä¾‹å¦‚: `LexerToken`, `ASTNode`)
- **å‡½æ•°/æ–¹æ³•**: `snake_case` (ä¾‹å¦‚: `parse_statement`, `get_next_token`)
- **å¸¸é‡**: `UPPER_SNAKE_CASE` (ä¾‹å¦‚: `MAX_DEPTH`, `DEFAULT_TIMEOUT`)
- **ç§æœ‰æˆå‘˜**: `_private_method`

### Docstring æ ¼å¼

```python
def parse_if_statement(self) -> IfBlock:
    """è§£æ if è¯­å¥ã€‚

    è¯­æ³•è§„åˆ™:
        if_statement ::= IF expression COLON NEWLINE
                         INDENT block DEDENT
                         [ELSE COLON NEWLINE INDENT block DEDENT]

    Returns:
        IfBlock: if è¯­å¥çš„ AST èŠ‚ç‚¹

    Raises:
        ParserError: è¯­æ³•é”™è¯¯æ—¶æŠ›å‡º
    """
    ...
```

---

## æ€§èƒ½è€ƒè™‘

### æ‰§è¡Œæ—¶é—´åˆ†å¸ƒ

```
å…¸å‹è„šæœ¬ï¼ˆ100 è¡Œï¼‰æ‰§è¡Œè€—æ—¶:
â”œâ”€ è¯æ³•åˆ†æ:    ~10ms  (1%)
â”œâ”€ è¯­æ³•åˆ†æ:    ~20ms  (2%)
â”œâ”€ è§£é‡Šæ‰§è¡Œ:    ~10ms  (1%)
â””â”€ æµè§ˆå™¨æ“ä½œ: ~960ms (96%)  â† ä¸»è¦ç“¶é¢ˆ
```

### ä¼˜åŒ–å»ºè®®

- **ä¸»è¦ç“¶é¢ˆåœ¨æµè§ˆå™¨æ“ä½œ**ï¼ŒDSL è§£é‡Šå¼€é”€å¯å¿½ç•¥
- ä¼˜åŒ–é‡ç‚¹ï¼šå‡å°‘ä¸å¿…è¦çš„æµè§ˆå™¨ç­‰å¾…ã€å¹¶è¡Œæ‰§è¡Œç‹¬ç«‹ä»»åŠ¡
- ä¸è¦è¿‡åº¦ä¼˜åŒ– Lexer/Parserï¼Œå¯è¯»æ€§ä¼˜å…ˆ

---

## è°ƒè¯•æŠ€å·§

### æŸ¥çœ‹ Token æµ

```python
from flowby import Lexer

tokens = Lexer().tokenize("let x = 10")
for t in tokens:
    print(f"{t.type.name:15} {t.value}")
```

### æŸ¥çœ‹ AST

```python
from flowby import Lexer, Parser

source = "if True: log 'Hello'"
tokens = Lexer().tokenize(source)
ast = Parser().parse(tokens)

import pprint
pprint.pprint(ast.__dict__)
```

### å¯ç”¨è¯¦ç»†æ—¥å¿—

```dsl
step "è°ƒè¯•æ­¥éª¤" with diagnosis detailed:
    # è¯¦ç»†è¯Šæ–­æŠ¥å‘Š: flowby-output/diagnosis/task-{uuid}.json
    let x = 10
    log x
```

### ä½¿ç”¨ pytest è°ƒè¯•

```bash
# è¿è¡Œå•ä¸ªæµ‹è¯•å¹¶æ˜¾ç¤ºæ‰“å°
pytest tests/test_file.py::test_function -v -s

# å¤±è´¥æ—¶è¿›å…¥è°ƒè¯•å™¨
pytest tests/test_file.py --pdb
```

---

## ç‰¹æ®Šæ³¨æ„äº‹é¡¹

### 1. v3.0 è¯­æ³•è¿ç§»

**æ‰€æœ‰ä¿®æ”¹å¿…é¡»éµå¾ª v3.0 è¯­æ³•**ï¼š

- ä½¿ç”¨ç¼©è¿›å—ï¼Œä¸ä½¿ç”¨ `end` å…³é”®å­—
- å¸ƒå°”å€¼: `True`/`False`ï¼ˆä¸æ˜¯ `true`/`false`ï¼‰
- ç©ºå€¼: `None`ï¼ˆä¸æ˜¯ `null`ï¼‰

### 2. å®ä¾‹éš”ç¦»

**ç¦æ­¢ä½¿ç”¨å…¨å±€çŠ¶æ€**ï¼š

- æ‰€æœ‰æ‰§è¡ŒçŠ¶æ€å¿…é¡»åœ¨ `ExecutionContext` ä¸­
- ä¸è¦ä½¿ç”¨å…¨å±€å˜é‡å­˜å‚¨å˜é‡ã€é¡µé¢å¯¹è±¡ç­‰
- ç¡®ä¿å¤šä»»åŠ¡å¹¶å‘å®‰å…¨

### 3. ç¬¦å·è¡¨ä¸€è‡´æ€§

**Parser å’Œ Interpreter å…±äº« SymbolTable**ï¼š

- Parser é˜¶æ®µï¼šè¯­ä¹‰æ£€æŸ¥ï¼ˆVR è§„åˆ™éªŒè¯ï¼‰
- Interpreter é˜¶æ®µï¼šå˜é‡æŸ¥æ‰¾å’Œä½œç”¨åŸŸç®¡ç†
- ç¡®ä¿ä¸¤è€…ä½¿ç”¨åŒä¸€ä¸ª `SymbolTableStack` å®ä¾‹

### 4. é”™è¯¯å¤„ç†

**ä½¿ç”¨æ˜ç¡®çš„é”™è¯¯ç±»å‹**ï¼š

- `LexerError`: è¯æ³•é”™è¯¯ï¼ˆéæ³•å­—ç¬¦ã€ç¼©è¿›é”™è¯¯ç­‰ï¼‰
- `ParserError`: è¯­æ³•é”™è¯¯ï¼ˆè¯­æ³•ä¸åŒ¹é…ã€è¯­ä¹‰è¿è§„ç­‰ï¼‰
- `ExecutionError`: è¿è¡Œæ—¶é”™è¯¯ï¼ˆå˜é‡æœªå®šä¹‰ã€ç±»å‹é”™è¯¯ç­‰ï¼‰

### 5. æµ‹è¯•è¦†ç›–

**æ–°ç‰¹æ€§å¿…é¡»åŒ…å«æµ‹è¯•**ï¼š

- è‡³å°‘åŒ…å«åŸºæœ¬åŠŸèƒ½æµ‹è¯•
- åŒ…å«è¾¹ç•Œæƒ…å†µæµ‹è¯•
- åŒ…å«é”™è¯¯å¤„ç†æµ‹è¯•
- ä½¿ç”¨åˆé€‚çš„ pytest marker

---

## AI åä½œå¼€å‘æ¨¡å¼

### æ¦‚è¿°

å¯¹äº**å¤§é‡é‡å¤æ€§ä¿®æ”¹ä»»åŠ¡**ï¼ˆå¦‚æ‰¹é‡ä¿®å¤æµ‹è¯•ã€é‡æ„ä»£ç ç­‰ï¼‰ï¼Œæ¨èä½¿ç”¨"åˆ†æ + æ‰§è¡Œ"çš„åŒ AI åä½œæ¨¡å¼ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚

### å·¥ä½œæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é˜¶æ®µ 1: é—®é¢˜åˆ†æï¼ˆæ¶æ„å¸ˆ AIï¼‰                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. è¿è¡Œæµ‹è¯•/å·¥å…·å‘ç°é—®é¢˜                                   â”‚
â”‚ 2. åˆ†æé—®é¢˜æ ¹æºå’Œå½±å“èŒƒå›´                                  â”‚
â”‚ 3. åˆ¶å®šä¿®å¤ç­–ç•¥å’ŒåŸåˆ™                                      â”‚
â”‚ 4. ç¼–å†™è¯¦ç»†çš„ä¿®å¤æ–‡æ¡£                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é˜¶æ®µ 2: æ‰¹é‡æ‰§è¡Œï¼ˆæ‰§è¡Œè€… AIï¼‰                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. è¯»å–ä¿®å¤æ–‡æ¡£                                           â”‚
â”‚ 2. æŒ‰ç…§æ¨¡æ¿é€ä¸ªä¿®å¤                                        â”‚
â”‚ 3. è¿è¡Œæµ‹è¯•éªŒè¯                                           â”‚
â”‚ 4. æŠ¥å‘Šæ‰§è¡Œç»“æœ                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é˜¶æ®µ 3: ç»“æœå®¡æŸ¥ï¼ˆæ¶æ„å¸ˆ AIï¼‰                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. æ£€æŸ¥ä¿®å¤è´¨é‡                                           â”‚
â”‚ 2. è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶                                        â”‚
â”‚ 3. Code Review                                          â”‚
â”‚ 4. æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è§’è‰²åˆ†å·¥

#### æ¶æ„å¸ˆ AIï¼ˆåˆ†æè€…ï¼‰

**èŒè´£ï¼š**
- ğŸ” è¯Šæ–­é—®é¢˜æ ¹æº
- ğŸ“Š è¯„ä¼°å½±å“èŒƒå›´
- ğŸ“‹ åˆ¶å®šä¿®å¤ç­–ç•¥
- ğŸ“ ç¼–å†™è¯¦ç»†æ–‡æ¡£
- âœ… å®¡æŸ¥æœ€ç»ˆç»“æœ
- ğŸš€ æäº¤ä»£ç å˜æ›´

**è¾“å‡ºæ–‡æ¡£ç¤ºä¾‹ï¼š**
- `PROBLEM_ANALYSIS.md` - é—®é¢˜å®Œæ•´åˆ†æ
  - é—®é¢˜å‘ç”Ÿåœ¨å“ªé‡Œ
  - é—®é¢˜æ˜¯ä»€ä¹ˆ
  - ä¸ºä»€ä¹ˆä¼šå‘ç”Ÿ
  - å¦‚ä½•ä¿®å¤
- `TEST_FIXES_NEEDED.md` - ä¿®å¤ä»»åŠ¡æ¸…å•
  - æ‰€æœ‰éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶å’Œä½ç½®
  - ä¿®æ”¹å‰/ä¿®æ”¹åä»£ç å¯¹æ¯”
  - ä¿®å¤åŸåˆ™å’Œæ³¨æ„äº‹é¡¹
  - éªŒè¯æ–¹æ³•

#### æ‰§è¡Œè€… AIï¼ˆå®æ–½è€…ï¼‰

**èŒè´£ï¼š**
- ğŸ”¨ æ‰§è¡Œæ‰¹é‡é‡å¤æ€§ä¿®æ”¹
- ğŸ“ æŒ‰ç…§æ¨¡æ¿ä¿®æ”¹ä»£ç 
- ğŸ§ª è¿è¡Œæµ‹è¯•éªŒè¯ä¿®å¤
- ğŸ“Š æŠ¥å‘Šæ‰§è¡Œè¿›åº¦

**å·¥ä½œè¦æ±‚ï¼š**
- ä¸¥æ ¼éµå¾ªæ–‡æ¡£æŒ‡å¯¼
- ä¿æŒä»£ç é£æ ¼ä¸€è‡´
- ä¸æ“…è‡ªä¿®æ”¹ç­–ç•¥
- é‡åˆ°é—®é¢˜åŠæ—¶æŠ¥å‘Š

### é€‚ç”¨åœºæ™¯

**æ¨èä½¿ç”¨åŒ AI æ¨¡å¼ï¼š**

1. **æ‰¹é‡æµ‹è¯•ä¿®å¤** - 100+ ä¸ªæµ‹è¯•éœ€è¦ç›¸åŒæ¨¡å¼çš„ä¿®æ”¹
2. **å¤§è§„æ¨¡é‡æ„** - é‡å‘½åå˜é‡/å‡½æ•°/ç±»ï¼ˆè·¨å¤šä¸ªæ–‡ä»¶ï¼‰
3. **ä»£ç è¿ç§»** - API å‡çº§ã€è¯­æ³•ç‰ˆæœ¬è¿ç§»
4. **æ ¼å¼åŒ–ä¿®å¤** - ä»£ç é£æ ¼ç»Ÿä¸€ã€æ³¨é‡Šæ›´æ–°
5. **æ–‡æ¡£ç”Ÿæˆ** - åŸºäºä»£ç è‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£

**ä¸æ¨èä½¿ç”¨ï¼ˆå• AI å³å¯ï¼‰ï¼š**

1. **æ¶æ„è®¾è®¡** - éœ€è¦æ·±åº¦æ€è€ƒå’Œåˆ›æ–°
2. **å¤æ‚ç®—æ³•** - éœ€è¦ç†è§£ä¸šåŠ¡é€»è¾‘
3. **Bug è°ƒæŸ¥** - éœ€è¦çµæ´»çš„è°ƒè¯•æ€è·¯
4. **å°è§„æ¨¡ä¿®æ”¹** - å°‘äº 10 å¤„ä¿®æ”¹

### å®æˆ˜æ¡ˆä¾‹ï¼š142 ä¸ªæµ‹è¯•å¤±è´¥ä¿®å¤

**èƒŒæ™¯ï¼š** v6.3 å¼•å…¥ VR-001 è¯­ä¹‰è§„åˆ™ï¼ˆå˜é‡ä½¿ç”¨å‰å¿…é¡»å£°æ˜ï¼‰ï¼Œå¯¼è‡´ 142 ä¸ªæ—§æµ‹è¯•å¤±è´¥ã€‚

**ä¼ ç»Ÿæ–¹å¼ï¼š** å• AI é€ä¸ªä¿®å¤ â†’ è€—æ—¶ 2-3 å°æ—¶ï¼Œæ˜“å‡ºé”™

**åä½œæ–¹å¼ï¼š**

```
æ¶æ„å¸ˆ AI (10 åˆ†é’Ÿ):
  â”œâ”€ è¿è¡Œ pytest åˆ†æå¤±è´¥åŸå› 
  â”œâ”€ å®šä½åˆ° VR-001 è¯­ä¹‰è§„åˆ™è§¦å‘
  â”œâ”€ ç¼–å†™ PROBLEM_ANALYSIS.md (é—®é¢˜åˆ†æ)
  â””â”€ ç¼–å†™ TEST_FIXES_NEEDED.md (ä¿®å¤æ¸…å•)

æ‰§è¡Œè€… AI (60 åˆ†é’Ÿ):
  â”œâ”€ è¯»å–ä¿®å¤æ–‡æ¡£
  â”œâ”€ æ‰¹é‡ä¿®æ”¹ 142 ä¸ªæµ‹è¯•
  â””â”€ è¿è¡Œæµ‹è¯•éªŒè¯

æ¶æ„å¸ˆ AI (5 åˆ†é’Ÿ):
  â”œâ”€ æ£€æŸ¥ä¿®å¤è´¨é‡
  â”œâ”€ è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶
  â””â”€ æäº¤åˆ° Git
```

**æ•ˆç‡æå‡ï¼š** 75% æ—¶é—´èŠ‚çœï¼Œé”™è¯¯ç‡é™ä½

### æ–‡æ¡£æ¨¡æ¿

#### PROBLEM_ANALYSIS.md æ¨¡æ¿

```markdown
# é—®é¢˜åˆ†ææŠ¥å‘Š

## ä¸€ã€é—®é¢˜å‘ç°
- æ—¶é—´ï¼š
- ç°è±¡ï¼š
- ç»Ÿè®¡æ•°æ®ï¼š

## äºŒã€é—®é¢˜å‘ç”Ÿåœ¨å“ªé‡Œ
- å—å½±å“çš„æ–‡ä»¶åˆ—è¡¨
- å¤±è´¥åˆ†å¸ƒè¡¨æ ¼

## ä¸‰ã€é—®é¢˜æ˜¯ä»€ä¹ˆ
- æ ¹æœ¬åŸå› 
- å…·ä½“é”™è¯¯ä¿¡æ¯
- æŠ€æœ¯ç»†èŠ‚

## å››ã€ä¸ºä»€ä¹ˆä¼šå‘ç”Ÿ
- å†å²åŸå› 
- è®¾è®¡é—®é¢˜
- æœ¬è´¨åˆ†æ

## äº”ã€å¦‚ä½•ä¿®å¤
- ä¿®å¤åŸåˆ™
- å…·ä½“æ­¥éª¤
- å®Œæ•´ç¤ºä¾‹
- æ³¨æ„äº‹é¡¹

## å…­ã€éªŒè¯æ–¹æ³•
- å•å…ƒæµ‹è¯•
- é›†æˆæµ‹è¯•
- éªŒæ”¶æ ‡å‡†
```

#### FIXES_NEEDED.md æ¨¡æ¿

```markdown
# ä¿®å¤ä»»åŠ¡æ¸…å•

## ä¿®å¤åŸåˆ™
[ç®€æ´æè¿°ä¿®å¤è§„åˆ™]

## æ–‡ä»¶æ¸…å•

### æ–‡ä»¶ 1: path/to/file.py

#### ä½ç½® 1 (è¡Œ X-Y)
**ä¿®æ”¹å‰ï¼š**
```python
[åŸå§‹ä»£ç ]
```

**ä¿®æ”¹åï¼š**
```python
[ä¿®å¤åä»£ç ]
```

**åŸå› ï¼š** [ä¸ºä»€ä¹ˆè¦è¿™æ ·æ”¹]

### æ–‡ä»¶ 2: ...
[é‡å¤ç›¸åŒç»“æ„]

## éªŒè¯æ¸…å•
- [ ] æ‰€æœ‰æ–‡ä»¶å·²ä¿®æ”¹
- [ ] æµ‹è¯•å…¨éƒ¨é€šè¿‡
- [ ] ä»£ç å®¡æŸ¥å®Œæˆ
```

### æ²Ÿé€šåè®®

**æ¶æ„å¸ˆ AI â†’ æ‰§è¡Œè€… AIï¼š**

```
ä»»åŠ¡ï¼šæ‰¹é‡ä¿®å¤æµ‹è¯•
æ–‡æ¡£ï¼šPROBLEM_ANALYSIS.md, TEST_FIXES_NEEDED.md
è¦æ±‚ï¼š
  1. ä¸¥æ ¼æŒ‰ç…§æ–‡æ¡£ä¿®æ”¹
  2. ä¿æŒä»£ç æ ¼å¼ä¸€è‡´
  3. é‡åˆ°é—®é¢˜ç«‹å³åœæ­¢å¹¶æŠ¥å‘Š
  4. å®ŒæˆåæŠ¥å‘Šç»Ÿè®¡æ•°æ®
```

**æ‰§è¡Œè€… AI â†’ æ¶æ„å¸ˆ AIï¼š**

```
æ‰§è¡ŒæŠ¥å‘Šï¼š
  - å·²å¤„ç†ï¼š142/142 ä¸ªæµ‹è¯•
  - æˆåŠŸï¼š142
  - å¤±è´¥ï¼š0
  - å¼‚å¸¸ï¼šæ— 
  - è€—æ—¶ï¼š60 åˆ†é’Ÿ

æµ‹è¯•ç»“æœï¼š
  - pytest: 1181 passed, 10 skipped
  - çŠ¶æ€ï¼šâœ… å…¨éƒ¨é€šè¿‡

è¯·æ±‚å®¡æŸ¥ã€‚
```

### æœ€ä½³å®è·µ

#### âœ… æ¨èåšæ³•

1. **è¯¦ç»†çš„æ–‡æ¡£** - æ¯ä¸ªä¿®æ”¹ç‚¹éƒ½è¦æœ‰æ¸…æ™°çš„è¯´æ˜
2. **ä»£ç å¯¹æ¯”** - ä¿®æ”¹å‰/åå¯¹æ¯”è®©æ‰§è¡Œè€…å®¹æ˜“ç†è§£
3. **éªŒè¯æ ‡å‡†** - æ˜ç¡®ä»€ä¹ˆç®—"ä¿®å¤æˆåŠŸ"
4. **å¼‚å¸¸å¤„ç†** - å‘Šè¯‰æ‰§è¡Œè€…é‡åˆ°æ„å¤–æƒ…å†µå¦‚ä½•å¤„ç†
5. **è¿›åº¦æŠ¥å‘Š** - æ‰§è¡Œè€…å®šæœŸæŠ¥å‘Šè¿›åº¦

#### âŒ é¿å…åšæ³•

1. **æ¨¡ç³ŠæŒ‡ä»¤** - "ä¿®å¤æ‰€æœ‰æµ‹è¯•"ï¼ˆæ²¡è¯´æ€ä¹ˆä¿®å¤ï¼‰
2. **ç¼ºä¹ç¤ºä¾‹** - åªæœ‰åŸåˆ™æ²¡æœ‰å…·ä½“ä¾‹å­
3. **å‡è®¾å¤ªå¤š** - å‡è®¾æ‰§è¡Œè€…ç†è§£ä¸šåŠ¡é€»è¾‘
4. **æ— éªŒè¯æ–¹æ³•** - ä¸çŸ¥é“å¦‚ä½•ç¡®è®¤ä¿®å¤æ­£ç¡®
5. **æ²‰é»˜æ‰§è¡Œ** - æ‰§è¡Œè€…ä¸æŠ¥å‘Šè¿›åº¦

### å·¥å…·æ¨è

**æ¶æ„å¸ˆ AI å¸¸ç”¨å·¥å…·ï¼š**
- `pytest` - æµ‹è¯•åˆ†æ
- `git diff` - ä»£ç å˜æ›´åˆ†æ
- `grep` / `rg` - ä»£ç æœç´¢
- `git log` - å†å²åˆ†æ

**æ‰§è¡Œè€… AI å¸¸ç”¨å·¥å…·ï¼š**
- `sed` - æ‰¹é‡æ›¿æ¢
- `awk` - æ–‡æœ¬å¤„ç†
- `find` + `xargs` - æ‰¹é‡æ“ä½œ
- è„šæœ¬è‡ªåŠ¨åŒ–å·¥å…·

### ç»éªŒæ€»ç»“

**ä½•æ—¶å€¼å¾—ç”¨åŒ AIï¼š**
- ä¿®æ”¹é‡ > 50 å¤„
- ä¿®æ”¹æ¨¡å¼é‡å¤
- éœ€è¦é«˜ç²¾åº¦
- æ—¶é—´ç´§è¿«

**åä½œæˆåŠŸå…³é”®ï¼š**
1. **æ¸…æ™°çš„ä»»åŠ¡è¾¹ç•Œ** - è°åšä»€ä¹ˆè¦æ˜ç¡®
2. **è¯¦ç»†çš„æ–‡æ¡£** - æ‰§è¡Œè€…èƒ½çœ‹æ‡‚å°±èƒ½åšå¥½
3. **åŠæ—¶çš„æ²Ÿé€š** - é‡åˆ°é—®é¢˜ç«‹å³å¯¹è¯
4. **è´¨é‡éªŒè¯** - æ¶æ„å¸ˆè¦å®¡æŸ¥ç»“æœ

---

## å¿«é€Ÿå®šä½ä»£ç ä½ç½®

### ä¿®æ”¹è¯æ³•åˆ†æ

â†’ `src/flowby/lexer.py`

### ä¿®æ”¹è¯­æ³•è§£æ

â†’ `src/flowby/parser.py` (æ·»åŠ  `_parse_*()` æ–¹æ³•)

### ä¿®æ”¹æ‰§è¡Œé€»è¾‘

â†’ `src/flowby/interpreter.py` (æ·»åŠ  `visit_*()` æ–¹æ³•)

### æ·»åŠ å†…ç½®å‡½æ•°

â†’ `src/flowby/builtin_functions.py` (æ·»åŠ åˆ° `BUILTIN_FUNCTIONS` å­—å…¸)

### æ·»åŠ å‘½åç©ºé—´

â†’ `src/flowby/builtin_namespaces.py` (å¦‚ `random.*`, `http.*`)

### æ·»åŠ æµè§ˆå™¨åŠ¨ä½œ

â†’ `src/flowby/actions/*.py` (navigation, interaction, assertion, wait, screenshot)

### ä¿®æ”¹ç³»ç»Ÿå˜é‡

â†’ `src/flowby/system_variables.py` (`page`, `env`, `response`)

---

**ç‰ˆæœ¬**: v1.0
**ç”Ÿæˆæ—¶é—´**: 2025-11-30
**ç»´æŠ¤**: ä¸ä»£ç åº“åŒæ­¥æ›´æ–°
