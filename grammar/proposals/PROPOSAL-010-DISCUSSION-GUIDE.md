# Grammar Proposal #010 讨论引导文档

> **目的**: 引导社区就 Resource 构造函数重构提案进行有效讨论
> **日期**: 2025-11-30
> **讨论期**: 2025-11-30 ~ 2025-12-07

---

## 🎯 讨论目标

1. 收集社区对提案动机的认同度
2. 评估方案设计的合理性
3. 确定迁移策略的可行性
4. 发现潜在问题和改进建议

---

## 📋 讨论要点

### 主题 1: 问题识别 ✅

**问题**: 当前 `resource` 语句是否存在局限性？

**讨论点**:
- 是否遇到过动态配置 API 客户端的需求？
- 是否需要在运行时获取 token 后创建 resource？
- 是否需要为不同环境创建多个 API 客户端实例？
- 还有其他使用痛点吗？

**引导问题**:
1. 您在实际项目中是否遇到过提案中描述的场景？
2. 当前的 `resource` 语句是否满足您的需求？
3. 您是如何解决这些问题的（如果有）？

---

### 主题 2: 方案评估 ⭐

**问题**: `Resource()` 构造函数方案是否合理？

**讨论点**:
- 语法设计是否清晰？
- 与 v3.0 Python 风格是否一致？
- 是否符合 KISS 原则？
- 参数设计是否完善？

**对比分析**:

| 方面 | 旧 `resource` | 新 `Resource()` |
|------|--------------|-----------------|
| 语法类型 | 特殊语句 | 普通表达式 |
| 初始化时机 | 解析时 | 运行时 |
| 参数灵活性 | 字面量 + env | 任意表达式 |
| 多实例支持 | ❌ | ✅ |

**引导问题**:
1. 新语法是否更直观易用？
2. 是否有更好的替代方案？
3. 参数设计是否缺少什么？

---

### 主题 3: 迁移策略 🔄

**问题**: 渐进式废弃策略是否合理？

**时间线**:
- **v5.2** (2周): 添加 `Resource()`，两种语法并存
- **v5.3** (1月): 废弃警告
- **v6.0** (3月): 完全移除

**迁移工具**:
```bash
flowby migrate resource script.flow
```

**引导问题**:
1. 3个月的迁移期是否足够？
2. 是否需要更详细的迁移文档？
3. 自动化迁移工具是否能覆盖大部分场景？

---

### 主题 4: 技术实现 🛠️

**问题**: 实现方案是否可行？

**改动范围**:
- 移除: ~200 行旧代码
- 新增: ~50 行新代码
- 复用: 90% 现有实现

**风险评估**:
- 破坏现有代码: **中** (提供迁移工具)
- 实现复杂度: **低** (复用现有架构)
- 性能影响: **无** (可能更好)

**引导问题**:
1. 实现方案是否有遗漏？
2. 是否有技术风险需要关注？
3. 测试策略是否完善？

---

## 🗣️ 常见疑问预设解答

### Q1: 为什么要做这个破坏性变更？

**A**: 当前 `resource` 语句的静态初始化模型已经无法满足动态配置、多实例等真实场景。重构为构造函数是最简洁、最一致的解决方案。

### Q2: 能否保留 `resource` 语句并增强？

**A**: 考虑过，但会导致：
1. 语法复杂度增加（需要支持表达式）
2. 与其他语法不一致（特殊语句异类）
3. 维护成本高（两种初始化模型）

统一为构造函数更符合 KISS 原则。

### Q3: 迁移工具能覆盖所有场景吗？

**A**: 能覆盖 95% 的常见场景：
- 基本 `resource from ...` 语句
- 带配置块的 `resource:` 语句

少数复杂场景可能需要手动调整，会在迁移报告中提示。

### Q4: 是否影响现有 API 调用语法？

**A**: **不影响**。API 调用语法保持完全不变：
```dsl
let user = api.getUser(userId=123)  # 不变
```

只是创建 API 客户端的方式改变。

### Q5: 为什么目标版本是 v6.0？

**A**: 这是 MAJOR 版本变更（破坏性变更）。根据语义化版本规范，必须升级主版本号。

---

## 📊 反馈收集表

### 态度调查

| 态度 | 投票 | 百分比 |
|------|------|--------|
| ✅ 支持 | - | - |
| ❌ 反对 | - | - |
| 🤔 中立/观望 | - | - |

### 关键问题投票

**Q1: 是否同意当前 resource 存在局限性？**
- [ ] 同意
- [ ] 不同意
- [ ] 不确定

**Q2: Resource() 构造函数方案是否合理？**
- [ ] 合理
- [ ] 不合理
- [ ] 有更好方案（请说明）

**Q3: 迁移时间线是否可接受？**
- [ ] 可接受
- [ ] 太短，需要更长
- [ ] 太长，可以更快

---

## 🎓 讨论最佳实践

### DO ✅

1. **基于事实讨论** - 提供真实使用场景
2. **建设性反馈** - 提出问题的同时给出建议
3. **尊重他人** - 即使观点不同也保持礼貌
4. **聚焦主题** - 围绕提案核心问题讨论

### DON'T ❌

1. **人身攻击** - 针对想法，不针对人
2. **离题讨论** - 保持聚焦于 Resource 构造函数
3. **空洞反对** - 给出具体理由
4. **重复内容** - 先阅读已有讨论

---

## 📅 讨论时间表

### Week 1: 社区讨论（2025-11-30 ~ 2025-12-07）

**周一-周三**: 收集初步反馈
- 动机认同度
- 方案合理性

**周四-周五**: 深入讨论
- 技术细节
- 迁移策略

**周六-周日**: 总结整理
- 汇总意见
- 识别共识和分歧

### Week 2: 核心团队评审（2025-12-08 ~ 2025-12-10）

**周一**: 内部评审
**周二**: 与社区代表讨论（如有分歧）
**周三**: 最终决策并公告

---

## 🔗 讨论渠道

### 主要渠道
- **GitHub Issue**: [Proposal #010 Discussion](链接)
- **GitHub PR**: [proposal/010-resource-constructor](链接)

### 辅助渠道
- **Discord**: #grammar-proposals 频道
- **GitHub Discussions**: Grammar 分类

### 注意事项
- 重要意见请在 GitHub Issue 留言（便于归档）
- Discord 适合快速讨论和澄清疑问
- GitHub Discussions 适合深入技术讨论

---

## 📝 讨论模板

为方便讨论，请使用以下模板：

```markdown
### 我的观点

**态度**: 支持 / 反对 / 中立

**理由**:
1. （第一点）
2. （第二点）

**建议**:
- （可选的改进建议）

**疑问**:
- （如果有不清楚的地方）
```

---

## 🎯 期望产出

### 讨论结束时应得到

1. **社区态度**: 支持/反对/中立的统计
2. **关键反馈**: 归类整理的意见清单
3. **改进建议**: 可行的优化方案
4. **风险识别**: 潜在问题和缓解措施
5. **共识确认**: 达成一致的方面

### 评审决策依据

核心团队将基于以下方面做出决策：

1. **社区支持度** (30%)
2. **技术可行性** (25%)
3. **设计质量** (20%)
4. **维护成本** (15%)
5. **战略契合度** (10%)

---

**感谢您的参与！您的意见对 Flowby 的发展至关重要。** 🌸
