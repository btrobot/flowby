# Grammar Proposal #005: Integer Type Support (æ•´æ•°ç±»å‹æ”¯æŒ)

> **ææ¡ˆç¼–å·**: #005
> **æå‡ºæ—¥æœŸ**: 2025-11-28
> **æå‡ºäºº**: DSL Core Team
> **çŠ¶æ€**: ğŸ“ Draft
> **ç›®æ ‡ç‰ˆæœ¬**: 4.0.0
> **å½±å“çº§åˆ«**: MAJOR (æ–°å¢ç±»å‹ç³»ç»Ÿï¼Œå‘åå…¼å®¹)

---

## ğŸ“‹ ææ¡ˆæ‘˜è¦

å¼•å…¥æ•´æ•°ç±»å‹ï¼ˆ`int`ï¼‰ä½œä¸ºç‹¬ç«‹çš„æ•°å­—ç±»å‹ï¼Œä¸æµ®ç‚¹æ•°ç±»å‹ï¼ˆ`float`ï¼‰å…±å­˜ï¼Œéµå¾ªPythoné£æ ¼çš„ç±»å‹æå‡è§„åˆ™ï¼Œå½»åº•è§£å†³CSSé€‰æ‹©å™¨æµ®ç‚¹æ•°é—®é¢˜ï¼Œæä¾›æ›´æ¸…æ™°çš„è¯­ä¹‰å’Œæ›´å¥½çš„ç”¨æˆ·ä½“éªŒã€‚

---

## ğŸ¯ åŠ¨æœºå’ŒèƒŒæ™¯

### é—®é¢˜æè¿°

DSLç›®å‰åªæ”¯æŒ `float` ç±»å‹çš„æ•°å­—ï¼Œå¯¼è‡´ä»¥ä¸‹é—®é¢˜ï¼š

**é—®é¢˜1: CSSé€‰æ‹©å™¨æµ®ç‚¹æ•°åŒ¹é…å¤±è´¥**
```dsl
# v3.4 å½“å‰åšæ³•ï¼ˆéœ€è¦workaroundï¼‰
for i in range(6):
    let digit = verification_code[i]
    let index_int = Math.floor(i)  # å¿…é¡»æ‰‹åŠ¨è½¬æ¢
    let selector = f".otp-input[data-index=\"{index_int}\"]"
    # å¦‚æœä¸è½¬æ¢ï¼Œä¼šç”Ÿæˆ: [data-index="0.0"] âŒ æ— æ³•åŒ¹é…HTML
```

**HTMLå®é™…ç»“æ„**:
```html
<input data-index="0" />  <!-- æ•´æ•°å±æ€§å€¼ -->
<input data-index="1" />
```

**é—®é¢˜**:
1. âŒ f-stringæ’å€¼ç”Ÿæˆ `"0.0"` è€Œé `"0"`
2. âŒ éœ€è¦æ‰‹åŠ¨è°ƒç”¨ `Math.floor()` workaround
3. âŒ ä»£ç ä¸å¤Ÿç›´è§‚å’Œç®€æ´

**é—®é¢˜2: è¯­ä¹‰ä¸æ¸…æ™°**
```dsl
let count = 5      # å®é™…æ˜¯ 5.0 (float)
let total = 10     # å®é™…æ˜¯ 10.0 (float)
let rate = 0.05    # 5.0 (float)
```

**é—®é¢˜**:
- âŒ æ— æ³•ä»å­—é¢é‡åŒºåˆ†æ•´æ•°å’Œæµ®ç‚¹æ•°
- âŒ ä¸Pythonè¯­ä¹‰ä¸ä¸€è‡´

**é—®é¢˜3: ç±»å‹æ··æ·†**
```python
# Python (æ¸…æ™°)
count = 5      # int
rate = 5.0     # float

# DSL v3.4 (æ··æ·†)
let count = 5  # 5.0 (float) - è¯­ä¹‰ä¸æ˜ç¡®
let rate = 5.0 # 5.0 (float)
```

### ä¸ºä»€ä¹ˆç°æœ‰åŠŸèƒ½ä¸å¤Ÿï¼Ÿ

**v3.4è§£å†³æ–¹æ¡ˆçš„å±€é™æ€§**:

1. **Math.floor() workaround**
   - âœ… èƒ½è§£å†³é—®é¢˜ï¼Œä½†éœ€è¦é¢å¤–ä»£ç 
   - âŒ ä¸å¤Ÿä¼˜é›…ï¼Œå¢åŠ å¿ƒæ™ºè´Ÿæ‹…
   - âŒ å®¹æ˜“è¢«é—å¿˜ï¼Œå¯¼è‡´bug

2. **å­—ç¬¦ä¸²æ’å€¼æ™ºèƒ½å¤„ç†**ï¼ˆæ›¾è€ƒè™‘çš„v3.4.1æ–¹æ¡ˆï¼‰
   - âœ… 1å°æ—¶å®ç°
   - âŒ æ²»æ ‡ä¸æ²»æœ¬
   - âŒ ç±»å‹ç³»ç»Ÿä»ç„¶æ··ä¹±

**æ ¹æœ¬é—®é¢˜**: DSLç¼ºå°‘çœŸæ­£çš„æ•´æ•°ç±»å‹

---

## ğŸ’¡ æè®®çš„è§£å†³æ–¹æ¡ˆ

### è¯­æ³•è®¾è®¡

#### æ•°å­—å­—é¢é‡

```ebnf
number_literal ::= integer_literal | float_literal

integer_literal ::= digit+
                  # ç¤ºä¾‹: 5, 42, 0, 1000

float_literal ::= digit+ "." digit+
                | "." digit+
                | digit+ "."
                # ç¤ºä¾‹: 5.0, 3.14, .5, 10.
```

#### ç±»å‹æå‡è§„åˆ™ï¼ˆPythoné£æ ¼ï¼‰

```dsl
# æ•´æ•°è¿ç®—
let a = 5      # int
let b = 2      # int
let c = a + b  # 7 (int)
let d = a * b  # 10 (int)

# æ··åˆè¿ç®—ï¼ˆè‡ªåŠ¨æå‡ä¸ºfloatï¼‰
let x = 5      # int
let y = 2.0    # float
let z = x + y  # 7.0 (float)

# é™¤æ³•è§„åˆ™
let r1 = 5 / 2   # 2.5 (float) - é™¤æ³•æ€»æ˜¯è¿”å›float
let r2 = 5 // 2  # 2 (int)     - æ•´é™¤è¿”å›int

# å¹‚è¿ç®—
let p1 = 2 ** 3    # 8 (int)
let p2 = 2 ** 3.0  # 8.0 (float)
```

### è¯¦ç»†è¯´æ˜

#### ç±»å‹ç³»ç»Ÿè§„åˆ™

| è¿ç®— | å·¦æ“ä½œæ•° | å³æ“ä½œæ•° | ç»“æœç±»å‹ | ç¤ºä¾‹ |
|------|---------|---------|---------|------|
| `+` | int | int | int | `5 + 2` â†’ `7` |
| `+` | int | float | float | `5 + 2.0` â†’ `7.0` |
| `+` | float | int | float | `5.0 + 2` â†’ `7.0` |
| `+` | float | float | float | `5.0 + 2.0` â†’ `7.0` |
| `-` | int | int | int | `5 - 2` â†’ `3` |
| `*` | int | int | int | `5 * 2` â†’ `10` |
| `/` | int | int | **float** | `5 / 2` â†’ `2.5` âš ï¸ |
| `//` | int | int | **int** | `5 // 2` â†’ `2` |
| `%` | int | int | int | `5 % 2` â†’ `1` |
| `**` | int | int | int | `2 ** 3` â†’ `8` |
| `**` | int | float | float | `2 ** 3.0` â†’ `8.0` |

âš ï¸ **å…³é”®è®¾è®¡å†³ç­–**: `/` è¿ç®—ç¬¦æ€»æ˜¯è¿”å› `float`ï¼Œä¿æŒä¸Pythonä¸€è‡´ï¼Œé¿å…æ•´æ•°é™¤æ³•é™·é˜±ã€‚

#### å†…ç½®å‡½æ•°æ›´æ–°

```dsl
# æ–°å¢ç±»å‹è½¬æ¢å‡½æ•°
let x = int("123")       # 123 (int)
let y = int(123.7)       # 123 (int) - å‘ä¸‹å–æ•´
let z = float(123)       # 123.0 (float)

# Mathå‡½æ•°è¿”å›int
let a = Math.floor(3.7)  # 3 (int)   - v3.4è¿”å›3.0
let b = Math.ceil(3.2)   # 4 (int)   - v3.4è¿”å›4.0
let c = Math.round(3.5)  # 4 (int)   - v3.4è¿”å›4.0

# range()è¿”å›intåˆ—è¡¨
let nums = range(5)      # [0, 1, 2, 3, 4] (List[int])
                         # v3.4è¿”å›[0.0, 1.0, 2.0, 3.0, 4.0]
```

### ä½¿ç”¨ç¤ºä¾‹

#### ç¤ºä¾‹ 1: CSSé€‰æ‹©å™¨ï¼ˆæ ¸å¿ƒåœºæ™¯ï¼‰

```flow
/**meta
grammar-version: 4.0
desc: OTP input with integer type
*/

step "è¾“å…¥éªŒè¯ç ":
    let verification_code = "123456"
    let code_length = len(verification_code)  # 6 (int)

    # âœ… v4.0: æ— éœ€Math.floor()
    for i in range(code_length):
        let digit = verification_code[i]
        let selector = f".otp-input[data-index=\"{i}\"]"
        # è‡ªåŠ¨ç”Ÿæˆ: [data-index="0"], [data-index="1"], ...

        select input where css=selector
        type digit
```

**v3.4å¯¹æ¯”**:
```dsl
# v3.4: éœ€è¦workaround
for i in range(code_length):
    let digit = verification_code[i]
    let index_int = Math.floor(i)  # âŒ é¢å¤–ä»£ç 
    let selector = f".otp-input[data-index=\"{index_int}\"]"
```

#### ç¤ºä¾‹ 2: æ¸…æ™°çš„è¯­ä¹‰

```flow
/**meta
grammar-version: 4.0
desc: Integer vs Float semantics
*/

step "è®¡æ•°å™¨ç¤ºä¾‹":
    # æ•´æ•°è®¡æ•°
    let count = 0           # int
    let max_retries = 3     # int

    for i in range(max_retries):
        count = count + 1   # int + int = int
        log f"Attempt {count}"

    # æµ®ç‚¹æ•°è®¡ç®—
    let rate = 0.05         # float
    let total = 100         # int
    let fee = total * rate  # int * float = float (5.0)
```

#### ç¤ºä¾‹ 3: ç±»å‹è½¬æ¢

```flow
/**meta
grammar-version: 4.0
desc: Type conversion examples
*/

step "ç±»å‹è½¬æ¢":
    # ä»å­—ç¬¦ä¸²è½¬æ¢
    let user_input = "123"
    let age = int(user_input)        # 123 (int)

    # ä»æµ®ç‚¹æ•°è½¬æ¢
    let pi = 3.14159
    let whole = int(pi)              # 3 (int)

    # æ˜¾å¼è½¬æ¢ä¸ºfloat
    let precise = float(age)         # 123.0 (float)

    # æ··åˆè¿ç®—è‡ªåŠ¨æå‡
    let mixed = age + pi             # 126.14159 (float)
```

#### ç¤ºä¾‹ 4: é™¤æ³•è¡Œä¸º

```flow
/**meta
grammar-version: 4.0
desc: Division behavior
*/

step "é™¤æ³•ç¤ºä¾‹":
    let a = 5
    let b = 2

    # æ™®é€šé™¤æ³•ï¼ˆæ€»æ˜¯è¿”å›floatï¼‰
    let result1 = a / b    # 2.5 (float)

    # æ•´é™¤ï¼ˆè¿”å›intï¼‰
    let result2 = a // b   # 2 (int)

    # å–ä½™ï¼ˆè¿”å›intï¼‰
    let result3 = a % b    # 1 (int)

    log f"5 / 2 = {result1}"   # "5 / 2 = 2.5"
    log f"5 // 2 = {result2}"  # "5 // 2 = 2"
    log f"5 % 2 = {result3}"   # "5 % 2 = 1"
```

---

## ğŸ” è¯­ä¹‰å’Œè¡Œä¸º

### æ‰§è¡Œè¯­ä¹‰

#### 1. è¯æ³•åˆ†æé˜¶æ®µ

```python
# Lexerè¯†åˆ«æ•´æ•°å’Œæµ®ç‚¹æ•°
"123"   â†’ Token(TokenType.INTEGER, 123)      # int
"123.0" â†’ Token(TokenType.NUMBER, 123.0)     # float
"0"     â†’ Token(TokenType.INTEGER, 0)        # int
".5"    â†’ Token(TokenType.NUMBER, 0.5)       # float
```

#### 2. è¯­æ³•åˆ†æé˜¶æ®µ

```python
# Parseræ„å»ºAST
Literal(value=123, value_type="int")     # æ•´æ•°å­—é¢é‡
Literal(value=123.0, value_type="float") # æµ®ç‚¹æ•°å­—é¢é‡
```

#### 3. è¿è¡Œæ—¶æ±‚å€¼

```python
# Evaluatoræ‰§è¡Œç±»å‹æå‡
def _eval_binary_op(left, op, right):
    # int + int â†’ int
    if isinstance(left, int) and isinstance(right, int):
        if op == '+':
            return left + right  # ä¿æŒint

    # å…¶ä»–æƒ…å†µæå‡ä¸ºfloat
    else:
        return float(left) + float(right)
```

### ä½œç”¨åŸŸè§„åˆ™

- ç±»å‹ä¿¡æ¯åœ¨ç¼–è¯‘æ—¶ç¡®å®šï¼ˆå­—é¢é‡ï¼‰
- è¿è¡Œæ—¶é€šè¿‡Pythonç±»å‹è¡¨ç¤ºï¼ˆ`int` vs `float`ï¼‰
- å˜é‡ç±»å‹å¯ä»¥æ”¹å˜ï¼ˆåŠ¨æ€ç±»å‹ï¼‰

```dsl
let x = 5      # x is int
x = 5.0        # x is now float (å…è®¸)
```

### å­—ç¬¦ä¸²æ’å€¼è¡Œä¸º

```dsl
let i = 0           # int
let j = 0.0         # float

log f"int: {i}"     # "int: 0"     (æ— å°æ•°ç‚¹)
log f"float: {j}"   # "float: 0.0" (æœ‰å°æ•°ç‚¹)

# æ•´æ•°å€¼çš„floatä¹Ÿæ™ºèƒ½å¤„ç†
let k = 5.0
log f"k: {k}"       # "k: 5" (å»æ‰.0)
```

### é”™è¯¯å¤„ç†

| é”™è¯¯æƒ…å†µ | è¡Œä¸º | ç¤ºä¾‹ |
|---------|------|------|
| å­—ç¬¦ä¸²è½¬intå¤±è´¥ | TypeError | `int("abc")` â†’ TypeError |
| é™¤ä»¥é›¶ | ZeroDivisionError | `5 / 0` â†’ ZeroDivisionError |
| ç±»å‹ä¸æ”¯æŒè¿ç®— | TypeError | `"abc" + 5` â†’ TypeError |

---

## ğŸ“Š å½±å“åˆ†æ

### ç‰ˆæœ¬å½±å“

- [x] **MAJOR** (å‘åå…¼å®¹çš„é‡å¤§æ–°åŠŸèƒ½)
  - æ–°å¢ç±»å‹ç³»ç»Ÿ
  - ä¸ç ´åç°æœ‰åŠŸèƒ½ï¼ˆ100%å…¼å®¹ï¼‰
  - éœ€è¦ç‰ˆæœ¬å·å‡çº§åˆ°4.0.0

- [ ] **MINOR** (å‘åå…¼å®¹çš„æ–°åŠŸèƒ½)
- [ ] **PATCH** (å‘åå…¼å®¹çš„ä¿®å¤)

### å‘åå…¼å®¹æ€§åˆ†æ

#### âœ… å®Œå…¨å…¼å®¹çš„åœºæ™¯

```dsl
# v3.4ä»£ç ï¼ˆå…¨æ˜¯floatï¼‰
let count = 5    # 5.0 (float)
let rate = 5.0   # 5.0 (float)

# v4.0è¡Œä¸ºï¼ˆåŒºåˆ†intå’Œfloatï¼‰
let count = 5    # 5 (int)      âœ… è¯­ä¹‰æ›´æ¸…æ™°
let rate = 5.0   # 5.0 (float)  âœ… ä¿æŒä¸å˜

# è¿ç®—å…¼å®¹æ€§
let a = 5         # int
let b = 2.0       # float
let c = a + b     # 7.0 (float) âœ… è‡ªåŠ¨æå‡
```

#### âœ… è¯­ä¹‰ä¿æŒä¸€è‡´

```dsl
# ç¡®ä¿ç°æœ‰ä»£ç è¡Œä¸ºä¸å˜
let x = 5 / 2

# v3.4: x = 2.5 (float)
# v4.0: x = 2.5 (float)  âœ… é™¤æ³•æ€»æ˜¯è¿”å›float
```

#### âš ï¸ éœ€è¦æ³¨æ„çš„è¾¹ç•Œæƒ…å†µ

```dsl
# åœºæ™¯ï¼šrange()è¿”å›ç±»å‹å˜åŒ–
let nums = range(5)

# v3.4: nums = [0.0, 1.0, 2.0, 3.0, 4.0] (List[float])
# v4.0: nums = [0, 1, 2, 3, 4]           (List[int])

# å½±å“ï¼šå¦‚æœä»£ç ä¾èµ–floatç±»å‹ï¼Œå¯èƒ½éœ€è¦è°ƒæ•´
# è§£å†³ï¼šæ˜¾å¼è½¬æ¢ list(map(float, range(5)))
# è¯„ä¼°ï¼šå®é™…å½±å“æå°ï¼Œå› ä¸ºintå¯ä»¥è‡ªåŠ¨æå‡ä¸ºfloat
```

### ç ´åæ€§å˜æ›´

âŒ **æ— ç ´åæ€§å˜æ›´** - 100%å‘åå…¼å®¹

**éªŒè¯ç­–ç•¥**:
1. æ‰€æœ‰v3.4æµ‹è¯•å¿…é¡»åœ¨v4.0é€šè¿‡
2. å›å½’æµ‹è¯•æ‰€æœ‰ç°æœ‰æµç¨‹
3. å…¼å®¹æ€§æµ‹è¯•å¥—ä»¶ï¼ˆ28ç§ç±»å‹ç»„åˆï¼‰

### æ€§èƒ½å½±å“

**é¢„æœŸå½±å“**:
- âœ… æ•´æ•°è¿ç®—å¯èƒ½æ›´å¿«ï¼ˆé¿å…æµ®ç‚¹æ•°å¼€é”€ï¼‰
- âœ… ç±»å‹åˆ¤æ–­å¼€é”€æå°ï¼ˆPythonåŸç”Ÿæ”¯æŒï¼‰
- âš ï¸ ç±»å‹è½¬æ¢å¯èƒ½æœ‰å¾®å°å¼€é”€ï¼ˆ<5%ï¼‰

**æ€§èƒ½åŸºå‡†æµ‹è¯•**:
```python
# æµ‹è¯•è®¡åˆ’
- æ•´æ•°è¿ç®— vs æµ®ç‚¹æ•°è¿ç®—
- ç±»å‹æå‡å¼€é”€
- å­—ç¬¦ä¸²æ’å€¼æ€§èƒ½
- range()ç”Ÿæˆæ€§èƒ½
```

---

## ğŸ› ï¸ å®ç°è®¡åˆ’

### é˜¶æ®µ1: æ ¸å¿ƒå®ç° (20å°æ—¶) - Week 1

**ç›®æ ‡**: è®©åŸºæœ¬çš„æ•´æ•°è¿ç®—å’Œå­—ç¬¦ä¸²æ’å€¼å·¥ä½œèµ·æ¥

#### 1.1 Lexerå±‚ (1.5å°æ—¶)
- [ ] æ·»åŠ  `TokenType.INTEGER` æšä¸¾
- [ ] ä¿®æ”¹ `_scan_number()` åŒºåˆ†intå’Œfloat
- [ ] å•å…ƒæµ‹è¯•ï¼š`tests/unit/dsl/test_lexer_int.py`

**å®ç°ä½ç½®**: `src/registration_system/dsl/lexer.py`

#### 1.2 Parserå±‚ (2.5å°æ—¶)
- [ ] ä¿®æ”¹ `_parse_primary()` å¤„ç†INTEGER token
- [ ] æ›´æ–°æ‰€æœ‰æ£€æŸ¥NUMBERçš„åœ°æ–¹
- [ ] å•å…ƒæµ‹è¯•ï¼š`tests/unit/dsl/test_parser_int.py`

**å®ç°ä½ç½®**: `src/registration_system/dsl/parser.py`

#### 1.3 ASTå±‚ (1å°æ—¶)
- [ ] Literalæ·»åŠ å¯é€‰`value_type`å­—æ®µ
- [ ] æ–‡æ¡£æ³¨é‡Šæ›´æ–°

**å®ç°ä½ç½®**: `src/registration_system/dsl/ast_nodes.py`

#### 1.4 Evaluatorå±‚ (6å°æ—¶)
- [ ] ä¿®æ”¹ `_eval_binary_op()` å®ç°ç±»å‹æå‡
- [ ] ä¿®æ”¹ `to_string()` æ™ºèƒ½å¤„ç†æ•´æ•°
- [ ] å•å…ƒæµ‹è¯•ï¼š`tests/unit/dsl/test_evaluator_int.py`

**å®ç°ä½ç½®**: `src/registration_system/dsl/expression_evaluator.py`

#### 1.5 å†…ç½®å‡½æ•° (4.5å°æ—¶)
- [ ] æ·»åŠ  `int()` ç±»å‹è½¬æ¢å‡½æ•°
- [ ] æ·»åŠ  `float()` ç±»å‹è½¬æ¢å‡½æ•°
- [ ] ä¿®æ”¹ `Math.floor/ceil/round()` è¿”å›int
- [ ] ä¿®æ”¹ `range()` è¿”å›List[int]
- [ ] å•å…ƒæµ‹è¯•ï¼š`tests/unit/dsl/test_builtin_int.py`

**å®ç°ä½ç½®**: `src/registration_system/dsl/builtin_functions.py`

#### 1.6 åˆæ­¥é›†æˆæµ‹è¯• (3.5å°æ—¶)
- [ ] æ•´æ•°è¿ç®—æµ‹è¯•
- [ ] å­—ç¬¦ä¸²æ’å€¼æµ‹è¯•
- [ ] range()é›†æˆæµ‹è¯•

### é˜¶æ®µ2: ç±»å‹ç³»ç»Ÿ (15å°æ—¶) - Week 2

#### 2.1 ç±»å‹è½¬æ¢è§„åˆ™è®¾è®¡ (2å°æ—¶)
- [ ] Pythoné£æ ¼ç±»å‹æå‡è§„åˆ™
- [ ] è¾¹ç•Œæƒ…å†µå¤„ç†
- [ ] æ–‡æ¡£ï¼š`DSL-TYPE-SYSTEM-ANALYSIS.md`æ›´æ–°

#### 2.2 ç±»å‹æå‡å®ç° (2å°æ—¶)
- [ ] äºŒå…ƒè¿ç®—ç¬¦å®Œæ•´å®ç°
- [ ] ä¸€å…ƒè¿ç®—ç¬¦å®ç°
- [ ] æ¯”è¾ƒè¿ç®—ç¬¦å®ç°

#### 2.3 ç±»å‹æ£€æŸ¥å™¨ï¼ˆå¯é€‰ï¼‰ (8å°æ—¶)
- [ ] æ–°å¢ `src/registration_system/dsl/type_system.py`
- [ ] é™æ€ç±»å‹æ£€æŸ¥
- [ ] è¿è¡Œæ—¶ç±»å‹éªŒè¯

#### 2.4 ç±»å‹ç³»ç»Ÿæµ‹è¯• (3å°æ—¶)
- [ ] 28ç§ç±»å‹ç»„åˆæµ‹è¯•
- [ ] è¾¹ç•Œæƒ…å†µæµ‹è¯•
- [ ] æ€§èƒ½åŸºå‡†æµ‹è¯•

### é˜¶æ®µ3: å…¼å®¹æ€§ä¸æµ‹è¯• (24.5å°æ—¶) - Week 3-4

#### 3.1 å•å…ƒæµ‹è¯• (12å°æ—¶)
- [ ] è¯æ³•åˆ†ææµ‹è¯•
- [ ] è¯­æ³•åˆ†ææµ‹è¯•
- [ ] ç±»å‹è¿ç®—æµ‹è¯•
- [ ] å†…ç½®å‡½æ•°æµ‹è¯•
- [ ] å­—ç¬¦ä¸²æ’å€¼æµ‹è¯•

#### 3.2 å…¼å®¹æ€§æµ‹è¯• (4å°æ—¶)
- [ ] v3.4ä»£ç å›å½’æµ‹è¯•
- [ ] æ‰€æœ‰ç°æœ‰æµç¨‹éªŒè¯
- [ ] Factory.aiæµç¨‹æµ‹è¯•

#### 3.3 é›†æˆæµ‹è¯• (3å°æ—¶)
- [ ] ç«¯åˆ°ç«¯æµ‹è¯•
- [ ] å®é™…åœºæ™¯æµ‹è¯•

#### 3.4 æ€§èƒ½æµ‹è¯• (2.5å°æ—¶)
- [ ] åŸºå‡†æµ‹è¯•
- [ ] æ€§èƒ½å›å½’æ£€æŸ¥

#### 3.5 æµ‹è¯•æ–‡æ¡£ (3å°æ—¶)
- [ ] æµ‹è¯•è¦†ç›–æŠ¥å‘Š
- [ ] æµ‹è¯•ç”¨ä¾‹æ–‡æ¡£

### é˜¶æ®µ4: æ–‡æ¡£ä¸å‘å¸ƒ (7å°æ—¶) - Week 4

#### 4.1 æ ¸å¿ƒæ–‡æ¡£æ›´æ–° (4å°æ—¶)
- [ ] MASTER.md: æ·»åŠ æ•´æ•°ç±»å‹è¯´æ˜
- [ ] CHANGELOG.md: v4.0.0æ¡ç›®
- [ ] DSL-TYPE-SYSTEM-ANALYSIS.md: è¯¦ç»†ç±»å‹è¯´æ˜

#### 4.2 è¿ç§»æŒ‡å— (2å°æ—¶)
- [ ] MIGRATION-GUIDE-v4.0.md
- [ ] å‘åå…¼å®¹æ€§è¯´æ˜
- [ ] æœ€ä½³å®è·µ

#### 4.3 å‘å¸ƒå‡†å¤‡ (1å°æ—¶)
- [ ] Release Notes
- [ ] GitHub Release
- [ ] Tag v4.0.0

---

## ğŸ§ª æµ‹è¯•ç­–ç•¥

### æµ‹è¯•è¦†ç›–ç›®æ ‡

| æµ‹è¯•ç±»å‹ | è¦†ç›–ç‡ç›®æ ‡ | ä¼˜å…ˆçº§ |
|---------|-----------|--------|
| è¯æ³•åˆ†æ | 100% | P0 |
| è¯­æ³•åˆ†æ | 100% | P0 |
| ç±»å‹è¿ç®— | 95%+ | P0 |
| å†…ç½®å‡½æ•° | 100% | P0 |
| å‘åå…¼å®¹ | 100% | P0 |
| é›†æˆæµ‹è¯• | 90%+ | P1 |

### å…³é”®æµ‹è¯•åœºæ™¯

#### 1. æ•´æ•°å­—é¢é‡è¯†åˆ«
```python
def test_integer_literals():
    assert tokenize("123") == [INTEGER(123)]
    assert tokenize("0") == [INTEGER(0)]
    assert tokenize("123.0") == [NUMBER(123.0)]
```

#### 2. ç±»å‹æå‡
```python
def test_type_promotion():
    assert eval("5 + 2") == 7      # int
    assert eval("5 + 2.0") == 7.0  # float
    assert eval("5 / 2") == 2.5    # float
    assert eval("5 // 2") == 2     # int
```

#### 3. å­—ç¬¦ä¸²æ’å€¼
```python
def test_string_interpolation():
    assert eval('f"x={0}"') == "x=0"      # æ— .0
    assert eval('f"x={0.0}"') == "x=0"    # æ™ºèƒ½å».0
    assert eval('f"x={0.5}"') == "x=0.5"  # ä¿ç•™å°æ•°
```

#### 4. å‘åå…¼å®¹
```python
def test_backward_compatibility():
    # v3.4ä»£ç åº”æ­£å¸¸å·¥ä½œ
    script_v34 = """
    let count = 5
    let rate = 5.0
    let sum = count + rate
    """
    assert exec(script_v34)['sum'] == 10.0
```

---

## âš ï¸ é£é™©å’ŒæŒ‘æˆ˜

### é£é™©1: å‘åå…¼å®¹æ€§ ğŸ”´

**é£é™©**: å¯èƒ½å½±å“ç°æœ‰ä»£ç çš„è¡Œä¸º

**ç¼“è§£æªæ–½**:
- âœ… é™¤æ³• `/` æ€»æ˜¯è¿”å›floatï¼ˆä¿æŒv3.4è¡Œä¸ºï¼‰
- âœ… å®Œæ•´çš„å…¼å®¹æ€§æµ‹è¯•å¥—ä»¶
- âœ… æ‰€æœ‰v3.4æµ‹è¯•å¿…é¡»é€šè¿‡

**è´£ä»»äºº**: Core Team
**æ£€æŸ¥ç‚¹**: é˜¶æ®µ3å®Œæˆ

### é£é™©2: ç±»å‹æ··æ·† ğŸŸ¡

**é£é™©**: ç”¨æˆ·ä¸æ¸…æ¥šä½•æ—¶æ˜¯intï¼Œä½•æ—¶æ˜¯float

**ç¼“è§£æªæ–½**:
- âœ… è¯¦ç»†çš„æ–‡æ¡£è¯´æ˜
- âœ… æ¸…æ™°çš„è¿ç§»æŒ‡å—
- âœ… ä¸°å¯Œçš„ç¤ºä¾‹ä»£ç 

**è´£ä»»äºº**: Documentation Team
**æ£€æŸ¥ç‚¹**: é˜¶æ®µ4å®Œæˆ

### é£é™©3: æµ‹è¯•å¤æ‚åº¦ ğŸŸ¡

**é£é™©**: 28ç§ç±»å‹ç»„åˆéœ€è¦å¤§é‡æµ‹è¯•

**ç¼“è§£æªæ–½**:
- âœ… å‚æ•°åŒ–æµ‹è¯•
- âœ… å±æ€§æµ‹è¯•ï¼ˆproperty-based testingï¼‰
- âœ… è‡ªåŠ¨åŒ–CI/CD

**è´£ä»»äºº**: QA Team
**æ£€æŸ¥ç‚¹**: é˜¶æ®µ3å®Œæˆ

---

## âœ… éªŒæ”¶æ ‡å‡†

### åŠŸèƒ½éªŒæ”¶

- [ ] æ•´æ•°å­—é¢é‡æ­£ç¡®è¯†åˆ« (`5` â†’ int, `5.0` â†’ float)
- [ ] æ•´æ•°è¿ç®—è¿”å›æ•´æ•° (`5 + 2` = `7` (int))
- [ ] ç±»å‹æå‡æ­£ç¡® (`5 + 2.0` = `7.0` (float))
- [ ] é™¤æ³•è¯­ä¹‰ä¿æŒ (`5 / 2` = `2.5` (float))
- [ ] æ•´é™¤è¿”å›æ•´æ•° (`5 // 2` = `2` (int))
- [ ] å­—ç¬¦ä¸²æ’å€¼æ— å°æ•°ç‚¹ (`f"{0}"` = `"0"`)
- [ ] `int()` å’Œ `float()` å‡½æ•°æ­£å¸¸å·¥ä½œ
- [ ] `range()` è¿”å›æ•´æ•°åˆ—è¡¨
- [ ] `Math` å‡½æ•°è¿”å›æ•´æ•°

### æ€§èƒ½éªŒæ”¶

- [ ] æ•´æ•°è¿ç®—æ€§èƒ½ â‰¥ æµ®ç‚¹æ•°è¿ç®—
- [ ] ç±»å‹è½¬æ¢å¼€é”€ < 5%
- [ ] æ— æ˜æ˜¾çš„æ€§èƒ½å›å½’

### å…¼å®¹æ€§éªŒæ”¶

- [ ] æ‰€æœ‰v3.4ä»£ç æ­£å¸¸å·¥ä½œ
- [ ] æ‰€æœ‰ç°æœ‰æµ‹è¯•é€šè¿‡ï¼ˆ37/37 Actions + 7/7 Extractionï¼‰
- [ ] Factory.aiæµç¨‹æ­£å¸¸è¿è¡Œ

### æ–‡æ¡£éªŒæ”¶

- [ ] MASTER.mdå®Œæ•´æ›´æ–°
- [ ] CHANGELOG.mdåŒ…å«v4.0.0è¯¦ç»†è¯´æ˜
- [ ] MIGRATION-GUIDE-v4.0.mdè¿ç§»æŒ‡å—å®Œæ•´
- [ ] ç¤ºä¾‹ä»£ç æ¼”ç¤ºæ‰€æœ‰æ–°ç‰¹æ€§
- [ ] DSL-TYPE-SYSTEM-ANALYSIS.mdæ›´æ–°

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

### æŠ€æœ¯åˆ†æ
- `INT-TYPE-IMPLEMENTATION-ANALYSIS.md` - 59.5å°æ—¶æŠ€æœ¯åˆ†æ
- `DSL-TYPE-SYSTEM-ANALYSIS.md` - 7ç§ç±»å‹å¯¹æ¯”
- `BACKWARD-COMPATIBILITY-CLEANUP-ANALYSIS.md` - v3.2å…¼å®¹æ€§åˆ†æ

### å‚è€ƒææ¡ˆ
- `PROPOSAL-002-while-loop.md` - æµç¨‹æ§åˆ¶ææ¡ˆå‚è€ƒ
- `PROPOSAL-003-unified-selector-expression-support.md` - è¡¨è¾¾å¼ææ¡ˆå‚è€ƒ
- `PROPOSAL-004-scroll-extract-expression-support.md` - è¡¨è¾¾å¼ä¿®å¤å‚è€ƒ

### å¤–éƒ¨å‚è€ƒ
- Python æ•°å­—ç±»å‹æ–‡æ¡£: https://docs.python.org/3/library/stdtypes.html#numeric-types-int-float-complex
- Python PEP 238 (Division): https://www.python.org/dev/peps/pep-0238/

---

## ğŸ“ å†³ç­–è®°å½•

### å†³ç­–1: é™¤æ³•æ€»æ˜¯è¿”å›float

**ç†ç”±**:
- âœ… ä¸Python 3è¡Œä¸ºä¸€è‡´
- âœ… é¿å…æ•´æ•°é™¤æ³•é™·é˜± (`5/2=2` çš„Cé£æ ¼)
- âœ… æ˜ç¡®è¯­ä¹‰ï¼š`/` = æµ®ç‚¹é™¤æ³•ï¼Œ`//` = æ•´é™¤

**æ—¥æœŸ**: 2025-11-28
**è´Ÿè´£äºº**: Core Team

### å†³ç­–2: é‡‡ç”¨Pythoné£æ ¼ç±»å‹æå‡

**ç†ç”±**:
- âœ… ç”¨æˆ·ç†Ÿæ‚‰ï¼ˆDSLå¯¹æ ‡Pythonï¼‰
- âœ… è§„åˆ™æ¸…æ™°ç®€å•
- âœ… ç¬¦åˆæ•°å­¦ç›´è§‰

**æ—¥æœŸ**: 2025-11-28
**è´Ÿè´£äºº**: Core Team

### å†³ç­–3: range()è¿”å›intåˆ—è¡¨

**ç†ç”±**:
- âœ… ä¸Pythonä¸€è‡´
- âœ… è¯­ä¹‰æ›´æ¸…æ™°ï¼ˆç´¢å¼•åº”è¯¥æ˜¯æ•´æ•°ï¼‰
- âœ… è§£å†³CSSé€‰æ‹©å™¨é—®é¢˜

**å½±å“**: å¯èƒ½å½±å“ä¾èµ–floatçš„ä»£ç ï¼ˆä½†å®é™…æå°‘ï¼‰
**æ—¥æœŸ**: 2025-11-28
**è´Ÿè´£äºº**: Core Team

---

## ğŸš€ å®æ–½æ—¶é—´çº¿

```
Week 1 (5 days):
  Day 1-2: Lexer + Parser
  Day 3-4: Evaluator
  Day 5: å†…ç½®å‡½æ•° + åˆæ­¥æµ‹è¯•

Week 2 (5 days):
  Day 1-2: ç±»å‹è½¬æ¢è§„åˆ™
  Day 3-5: ç±»å‹ç³»ç»Ÿå®ç°ä¸æµ‹è¯•

Week 3 (5 days):
  Day 1-3: å•å…ƒæµ‹è¯• + å…¼å®¹æ€§æµ‹è¯•
  Day 4-5: é›†æˆæµ‹è¯• + æ€§èƒ½æµ‹è¯•

Week 4 (5 days):
  Day 1-3: æ–‡æ¡£æ›´æ–° + è¿ç§»æŒ‡å—
  Day 4-5: å‘å¸ƒå‡†å¤‡ + v4.0.0 Release
```

**æ€»è®¡**: 20ä¸ªå·¥ä½œæ—¥ (4å‘¨) / 59.5å°æ—¶

---

## ğŸ“¢ å‘å¸ƒè®¡åˆ’

### Pre-release: v4.0.0-beta.1
- **æ—¶é—´**: Week 1ç»“æŸ
- **å†…å®¹**: æ ¸å¿ƒå®ç°å®Œæˆ
- **ç›®æ ‡**: å†…éƒ¨æµ‹è¯•å’Œåé¦ˆæ”¶é›†

### Release Candidate: v4.0.0-rc.1
- **æ—¶é—´**: Week 2-3ç»“æŸ
- **å†…å®¹**: ç±»å‹ç³»ç»Ÿå®Œå–„ï¼Œæµ‹è¯•å®Œæˆ
- **ç›®æ ‡**: ç¤¾åŒºæµ‹è¯•å’Œbugä¿®å¤

### æ­£å¼å‘å¸ƒ: v4.0.0
- **æ—¶é—´**: Week 4ç»“æŸ
- **å†…å®¹**: æ‰€æœ‰éªŒæ”¶æ ‡å‡†é€šè¿‡
- **ç›®æ ‡**: ç”Ÿäº§ç¯å¢ƒå°±ç»ª

---

## ğŸ¯ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ç«‹å³è¡ŒåŠ¨ (æœ¬å‘¨)
1. [ ] è¯„å®¡æœ¬ææ¡ˆ
2. [ ] ç¡®è®¤å®æ–½æ—¶é—´çº¿
3. [ ] åˆ†é…å¼€å‘èµ„æº
4. [ ] åˆ›å»ºfeatureåˆ†æ”¯: `feature/int-type-support`

### Week 1å¯åŠ¨
1. [ ] åœ¨MASTER.mdæ·»åŠ æ•´æ•°ç±»å‹è¡Œï¼ˆçŠ¶æ€ï¼šğŸš§ï¼‰
2. [ ] å¼€å§‹Lexerå®ç°
3. [ ] æ¯æ—¥è¿›åº¦åŒæ­¥

---

**ææ¡ˆçŠ¶æ€**: ğŸ“ Draft - ç­‰å¾…è¯„å®¡
**ä¸‹æ¬¡è¯„å®¡**: TBD
**è´Ÿè´£äºº**: DSL Core Team
